from scapy.layers.inet import ICMP, Ether, IP
from scapy.all import srp1, get_if_addr, get_if_hwaddr
from libs.aux_funcs import type_wrapper,attack_cat,attack_layer,attack_type

@type_wrapper(name="ICMP Flood", type=attack_type.DoS, category=attack_cat.Attack, layer=attack_layer.L4, arg_list=[])
def icmp_flood(args):
    return ICMP()

@type_wrapper(name="Ping test", type=attack_type.Test, category=attack_cat.Attack, layer=attack_layer.L2, arg_list=['interface','dest_ip','dest_mac'])
def icmp_test(args):
    iface=args["interface"]
    dst_ip = args["dest_ip"]
    dst_mac = args["dest_mac"]
    pkt = Ether(dst=dst_mac, src=get_if_hwaddr(iface))/IP(dst=dst_ip, src=get_if_addr(iface))/ICMP()
    rsp = srp1(pkt, iface=iface)
    if rsp != None:
        print("ICMP Response received")
    else:
        print("No ICMP Response")